<!doctype html>
<html>
    <head>
        <title>Socket.IO chat</title>
        <style>
            body, html {
                height: 100%;
            }

            #container {
                height: 100%;
                width: 100%;
            }
        </style>
    </head>
    <body>
        <div id="container">
            <canvas id="cpu"></canvas>
        </div>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
        <script src="/socket.io/socket.io.js"></script>
        <script src="bower_components/chartjs/Chart.min.js"></script>

        <script>
            var socket = io();
            var charts;

            socket.on("status", function(data) {
                charts.cpu.addData([data.cpu], time(new Date()));
                var num = charts.cpu.datasets[0].points.length;

                if(num > 20) {
                    charts.cpu.removeData();
                }

                console.log(data);
            });

            charts = setupCharts();


            function setupCharts() {
                var objects = {};

                var data = {
                    labels: ["02:13:31", "02:13:32"],
                    datasets: [
                        {
                            label: "cpu",
                            data: [2.3, 3.3]
                        }
                    ]
                };

                var options = {
                    responsive: true
                };

                var context = document.getElementById("cpu").getContext("2d");
                var cpuChart = new Chart(context).Line(data, options);
                cpuChart.addData([3.1], "123132");

                objects.cpu = cpuChart;

                return objects;
            }

            function time(date) {
                return date.getHours() + ":" + date.getMinutes() + ":" + date.getSeconds()
            }

        </script>
    </body>
</html>